<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.0/sandstone/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/solarized-light.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-grid.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-theme-balham.min.css" rel="stylesheet" type="text/css">
        <link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" type="text/css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    </head>
    <body>
        <p id="loading">Loading ...</p>
        <div id="app"></div>
    </body>
    <script id="state" type="text">"{:options {:reverse-notes? false, :header? false, :notes-in-cards? false, :initially-collapse? false, :auto-scroll? false, :port 1903, :custom-header [:div {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} \"(notespace)\" [:p \"Fri Jul 16 14:40:52 IDT 2021\"] nil [:hr]], :custom-footer [:div [:hr] [:hr]]}, :ids [\"57\" \"58\" \"59\" \"60\" \"61\" \"62\" \"63\" \"64\" \"65\" \"66\" \"67\" \"68\" \"69\" \"70\" \"71\" \"72\" \"73\" \"74\" \"75\" \"76\" \"77\" \"78\" \"79\" \"80\" \"81\" \"82\" \"83\" \"84\" \"85\" \"86\" \"87\" \"88\" \"89\" \"90\" \"91\" \"92\" \"93\" \"94\" \"95\" \"96\" \"97\" \"98\" \"99\" \"100\" \"101\" \"102\" \"103\" \"104\" \"105\" \"106\" \"107\" \"108\" \"109\" \"110\" \"111\"], :id->content {\"58\" [:div [:p] nil nil [:p/markdown \"# Handling Missing Data\"]], \"88\" [:div [:p] [:div [:p/code {:code \"(require '[tech.v3.dataset.column-filters :as cf]\\n         '[tech.v3.dataset.column :as ds-col])\", :bg-class \"bg-light\"}]] nil nil], \"108\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/replace-missing DS2 [:A] :mid)\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"322px\"}} [:p/markdown \"_unnamed [5 1]:\\n\\n| :A |\\n|---:|\\n|  1 |\\n|  1 |\\n|  2 |\\n|  2 |\\n|  3 |\\n\"]]], \"93\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/drop-columns DS1 (tablecloth/column-names\\n                              (cf/column-filter DS1 #(= 3  (count (vec (ds-col/missing %)))))))\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"230px\"}} [:p/markdown \"_unnamed [3 3]:\\n\\n| :A | :B | :C |\\n|---:|---:|---:|\\n|  1 |    |  2 |\\n|  2 |  3 |  5 |\\n|    |  4 |  6 |\\n\"]]], \"83\" [:div [:p] nil nil [:p/markdown \"We cannot drop single values from a DataFrame; we can only drop full rows or\\nfull columns. Depending on the application, you might want one or the other, so\\ndropna() gives a number of options for a DataFrame.\\n\\nBy default, dropna() will drop all rows in which any null value is present:\"]], \"69\" [:div [:p] [:div [:p/code {:code \"(ds/brief vals1)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"({:min 1.0,\\n  :n-missing 1,\\n  :col-name :A,\\n  :mean 2.6666666666666665,\\n  :datatype :int64,\\n  :skew -0.9352195295828236,\\n  :standard-deviation 1.5275252316519465,\\n  :quartile-3 4.0,\\n  :n-valid 3,\\n  :quartile-1 1.0,\\n  :median 3.0,\\n  :max 4.0,\\n  :first 1,\\n  :last 4})\\n\"}]], \"87\" [:div [:p] nil nil [:p/markdown \"But this drops some good data as well; you might rather be interested in\\ndropping rows or columns with all NA values, or a majority of NA values. This\\ncan be specified through the how or thresh parameters, which allow fine control\\nof the number of nulls to allow through.\\n\\nThe default is how='any', such that any row or column (depending on the axis\\nkeyword) containing a null value will be dropped. You can also specify\\nhow='all', which will only drop rows/columns that are all null values:\"]], \"105\" [:div [:p] nil nil [:p/markdown \"Or we can specify a up-fill to propagate the next values up:\"]], \"60\" [:div [:p] nil nil [:p/markdown \"## Trade-Offs in Missing Data Conventions\"]], \"82\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\nDS\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"230px\"}} [:p/markdown \"_unnamed [3 3]:\\n\\n| :A | :B | :C |\\n|---:|---:|---:|\\n|  1 |    |  2 |\\n|  2 |  3 |  5 |\\n|    |  4 |  6 |\\n\"]]], \"101\" [:div [:p] nil nil [:p/markdown \"We can fill NA entries with a single value, such as zero:\"]], \"59\" [:div [:p] nil nil [:p/markdown \"The difference between data found in many tutorials and data in the real world\\nis that real-world data is rarely clean and homogeneous. In particular, many\\ninteresting datasets will have some amount of data missing. To make matters even\\nmore complicated, different data sources may indicate missing data in different\\nways.\\n\\nIn this section, we will discuss some general considerations for missing data,\\ndiscuss how Pandas chooses to represent it, and demonstrate some built-in Pandas\\ntools for handling missing data in Python. Here and throughout the book, we'll\\nrefer to missing data in general as null, NaN, or NA values.\"]], \"89\" [:div [:p] [:div [:p/code {:code \"(def DS1 (tablecloth/add-or-replace-column DS :D nil))\", :bg-class \"bg-light\"}]] nil nil], \"61\" [:div [:p] nil nil [:p/markdown \"There are a number of schemes that have been developed to indicate the\\npresence of missing data in a table or DataFrame. Generally, they revolve around\\none of two strategies: using a mask that globally indicates missing values, or\\nchoosing a sentinel value that indicates a missing entry.\\n\\nIn the masking approach, the mask might be an entirely separate Boolean array,\\nor it may involve appropriation of one bit in the data representation to locally\\nindicate the null status of a value.\\n\\nIn the sentinel approach, the sentinel value could be some data-specific\\nconvention, such as indicating a missing integer value with -9999 or some rare\\nbit pattern, or it could be a more global convention, such as indicating a\\nmissing floating-point value with NaN (Not a Number), a special value which is\\npart of the IEEE floating-point specification.\\n\\nNone of these approaches is without trade-offs: use of a separate mask array\\nrequires allocation of an additional Boolean array, which adds overhead in both\\nstorage and computation. A sentinel value reduces the range of valid values that\\ncan be represented, and may require extra (often non-optimized) logic in CPU and\\nGPU arithmetic. Common special values like NaN are not available for all data\\ntypes.\\n\\nAs in most cases where no universally optimal choice exists, different languages\\nand systems use different conventions. For example, the R language uses reserved\\nbit patterns within each data type as sentinel values indicating missing data,\\nwhile the SciDB system uses an extra byte attached to every cell which indicates\\na NA state.\"]], \"57\" [:div [:p] nil nil nil], \"68\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\nvals1\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"276px\"}} [:p/markdown \"_unnamed [4 1]:\\n\\n| :A |\\n|---:|\\n|  1 |\\n|    |\\n|  3 |\\n|  4 |\\n\"]]], \"96\" [:div [:p] nil nil [:p/markdown \"### Filling null values\"]], \"80\" [:div [:p] nil nil [:p/markdown \"For a DataFrame, there are more options. Consider the following DataFrame:\"]], \"67\" [:div [:p] [:div [:p/code {:code \"(def vals1 (tablecloth/dataset {:A [1 nil 3 4]}))\", :bg-class \"bg-light\"}]] nil nil], \"81\" [:div [:p] [:div [:p/code {:code \"(def DS (tablecloth/dataset {:A [1 2 nil]\\n                             :B [nil 3 4]\\n                             :C [2 5 6]}))\", :bg-class \"bg-light\"}]] nil nil], \"98\" [:div [:p] nil nil [:p/markdown \"Consider the following dataset:\"]], \"107\" [:div [:p] nil nil [:p/markdown \"Or we can specify a mid-fill to calculate the missing value:\"]], \"73\" [:div [:p] nil nil [:p/markdown \"### Detecting null values\"]], \"78\" [:div [:p] nil nil [:p/markdown \"In addition to the masking used before, there are the convenience methods,\\n`drop-missing` (which removes NA values) and `replace-missing` (which fills in\\nNA values). For a Series, the result is straightforward:\"]], \"111\" [:div [:p] nil nil [:p/markdown \"Notice that if a previous value is not available during a down fill, the up\\nvalue are used.\"]], \"66\" [:div [:p] [:div [:p/code {:code \"(require '[tablecloth.api :as tablecloth]\\n         '[tech.v3.dataset :as ds]\\n         '[tech.v3.datatype.functional :as dfn])\", :bg-class \"bg-light\"}]] nil nil], \"100\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\nDS2\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"322px\"}} [:p/markdown \"_unnamed [5 1]:\\n\\n| :A |\\n|---:|\\n|  1 |\\n|    |\\n|  2 |\\n|    |\\n|  3 |\\n\"]]], \"106\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/replace-missing DS2 [:A] :up)\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"322px\"}} [:p/markdown \"_unnamed [5 1]:\\n\\n| :A |\\n|---:|\\n|  1 |\\n|  2 |\\n|  2 |\\n|  3 |\\n|  3 |\\n\"]]], \"90\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\nDS1\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"230px\"}} [:p/markdown \"_unnamed [3 4]:\\n\\n| :A | :B | :C | :D |\\n|---:|---:|---:|----|\\n|  1 |    |  2 |    |\\n|  2 |  3 |  5 |    |\\n|    |  4 |  6 |    |\\n\"]]], \"62\" [:div [:p] nil nil [:p/markdown \"## Missing Data in Dataset\"]], \"75\" [:div [:p] [:div [:p/code {:code \"(def data (tablecloth/dataset {:A [1 Float/NaN \\\"hello\\\" nil]}))\", :bg-class \"bg-light\"}]] nil nil], \"76\" [:div [:p] [:div [:p/code {:code \"(ds/missing data)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"{3}\\n\"}]], \"110\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/replace-missing DS2 [:A] :lerp)\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"322px\"}} [:p/markdown \"_unnamed [5 1]:\\n\\n|  :A |\\n|----:|\\n| 1.0 |\\n| 1.5 |\\n| 2.0 |\\n| 2.5 |\\n| 3.0 |\\n\"]]], \"97\" [:div [:p] nil nil [:p/markdown \"Sometimes rather than dropping NA values, you'd rather replace them with a\\nvalid value. This value might be a single number like zero, or it might be some\\nsort of imputation or interpolation from the good values. You could do this\\nin-place using the isnull() method as a mask, but because it is such a common\\noperation tech.ml.dataset provides the `replace-missing` function, which returns\\na copy of the array with the null values replaced.\"]], \"94\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/drop-rows DS1 (fn [row]\\n                            (< 3 (count (filter some? (vals row))))))\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"230px\"}} [:p/markdown \"_unnamed [3 4]:\\n\\n| :A | :B | :C | :D |\\n|---:|---:|---:|----|\\n|  1 |    |  2 |    |\\n|  2 |  3 |  5 |    |\\n|    |  4 |  6 |    |\\n\"]]], \"99\" [:div [:p] [:div [:p/code {:code \"(def DS2 (tablecloth/dataset {:A [1 nil 2 nil 3]}))\", :bg-class \"bg-light\"}]] nil nil], \"70\" [:div [:p] nil nil [:p/markdown \"It is different from Pandas dataframe that missing value is just ignored in\\ntech.ml.dataset:\"]], \"77\" [:div [:p] nil nil [:p/markdown \"### Dropping null values\"]], \"63\" [:div [:p] nil nil [:p/markdown \"The way in which Pandas handles missing values is constrained by its reliance\\non the NumPy package, which does not have a built-in notion of NA values for\\nnon-floating-point data types.\\n\\nPandas could have followed R's lead in specifying bit patterns for each\\nindividual data type to indicate nullness, but this approach turns out to be\\nrather unwieldy. While R contains four basic data types, NumPy supports far more\\nthan this: for example, while R has a single integer type, NumPy supports\\nfourteen basic integer types once you account for available precisions,\\nsignedness, and endianness of the encoding. Reserving a specific bit pattern in\\nall available NumPy types would lead to an unwieldy amount of overhead in\\nspecial-casing various operations for various types, likely even requiring a new\\nfork of the NumPy package. Further, for the smaller data types (such as 8-bit\\nintegers), sacrificing a bit to use as a mask will significantly reduce the\\nrange of values it can represent.\\n\\nNumPy does have support for masked arrays – that is, arrays that have a separate\\nBoolean mask array attached for marking data as \\\"good\\\" or \\\"bad\\\". Pandas\\ncould have derived from this, but the overhead in both storage, computation, and\\ncode maintenance makes that an unattractive choice.\\n\\nWith these constraints in mind, Pandas chose to use sentinels for missing data,\\nand further chose to use two already-existing Python null values: the special\\nfloating-point NaN value, and the Python None object. This choice has some side\\neffects, as we will see, but in practice ends up being a good compromise in most\\ncases of interest.\"]], \"84\" [:div [:p] [:div [:p/code {:code \"(tablecloth/drop-missing DS)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"_unnamed [1 3]:\\n\\n| :A | :B | :C |\\n|---:|---:|---:|\\n|  2 |  3 |  5 |\\n\\n\"}]], \"104\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/replace-missing DS2 [:A] :down)\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"322px\"}} [:p/markdown \"_unnamed [5 1]:\\n\\n| :A |\\n|---:|\\n|  1 |\\n|  1 |\\n|  2 |\\n|  2 |\\n|  3 |\\n\"]]], \"95\" [:div [:p] nil nil [:p/markdown \"Here the first and last row have been dropped, because they contain only two\\nnon-null values.\"]], \"102\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/replace-missing DS2 [:A] :value 0)\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"322px\"}} [:p/markdown \"_unnamed [5 1]:\\n\\n| :A |\\n|---:|\\n|  1 |\\n|  0 |\\n|  2 |\\n|  0 |\\n|  3 |\\n\"]]], \"74\" [:div [:p] nil nil [:p/markdown \"tech.ml.dataset data structures have two useful methods for detecting null data:\\n`missing`. Either one will return a Boolean mask over the data. For example:\"]], \"109\" [:div [:p] nil nil [:p/markdown \"Or we can specify a Linear interpolation fill to calculate the missing value:\"]], \"85\" [:div [:p] nil nil [:p/markdown \"Alternatively, you can drop NA values along a different axis; axis=1 drops all\\ncolumns containing a null value:\"]], \"72\" [:div [:p] nil nil [:p/markdown \"## Operating on Missing Values\"]], \"103\" [:div [:p] nil nil [:p/markdown \"We can specify a down-fill to propagate the previous value down:\"]], \"91\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(tablecloth/drop-columns DS1 (tablecloth/column-names\\n                              (cf/column-filter DS1 #(= (ds/row-count DS1) (count (vec (ds-col/missing %)))))))\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"230px\"}} [:p/markdown \"_unnamed [3 3]:\\n\\n| :A | :B | :C |\\n|---:|---:|---:|\\n|  1 |    |  2 |\\n|  2 |  3 |  5 |\\n|    |  4 |  6 |\\n\"]]], \"65\" [:div [:p] nil nil [:p/markdown \"The first sentinel value used by Pandas is None, a Python singleton object\\nthat is often used for missing data in Python code. Because it is a Python\\nobject, None cannot be used in any arbitrary NumPy/Pandas array, but only in\\narrays with data type 'object' (i.e., arrays of Python objects):\"]], \"71\" [:div [:p] [:div [:p/code {:code \"(dfn/sum (vals1 :A))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"8.0\\n\"}]], \"86\" [:div [:p] [:div [:p/code {:code \"(tablecloth/drop-missing DS :A)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"_unnamed [2 3]:\\n\\n| :A | :B | :C |\\n|---:|---:|---:|\\n|  1 |    |  2 |\\n|  2 |  3 |  5 |\\n\\n\"}]], \"64\" [:div [:p] nil nil [:p/markdown \"### None: Clojure missing data\"]], \"92\" [:div [:p] nil nil [:p/markdown \"For finer-grained control, the thresh parameter lets you specify a minimum\\nnumber of non-null values for the row/column to be kept:\"]], \"79\" [:div [:p] [:div [:p/code {:code \"(tablecloth/drop-missing data)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"_unnamed [3 1]:\\n\\n|    :A |\\n|-------|\\n| 1.000 |\\n|   NAN |\\n| hello |\\n\\n\"}]]}}"</script>
    <script src="gorilla-notes/js/compiled/main.js"></script>
</html>
